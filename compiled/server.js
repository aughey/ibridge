var common=require("./common"),net=require("net"),argv=require("optimist"),server=common.newServer(argv.p||3001);server.newEndpoint("open",function(e){var t=net.connect(22,"localhost",function(){function n(e){t.write(new Buffer(e.d,"binary"))}var r=server.newEndpoint(null,n,function(){t.end()});t.on("data",function(t){server.sendMessage({c:e.i,d:t.toString("binary")})}),t.on("end",function(){r.close()}),server.sendMessage({c:e.i,i:r.id})})}),setInterval(function(){server.sendMessage({c:"p"})},1e3);